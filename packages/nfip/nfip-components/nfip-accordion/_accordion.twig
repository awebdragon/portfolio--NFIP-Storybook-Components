{% set accordionRandomID = random() %}

{% if accordions_bg_color is not empty %}
  {% set globalTitleBG = true %}
{% else %}
  {% set globalTitleBG = false %}
{% endif %}

{% if accordions_content_bg_color is not empty %}
  {% set globalContentBG = true %}
{% else %}
  {% set globalContentBG = false %}
{% endif %}

<div class="usa-accordion nfip-accordion{% if accordion_style == "Icon" %} nfip-icon-accordion{% endif %}{% if multiselectable == "true" %} usa-accordion--multiselectable{% endif %}{% if extra_classes %} {{ extra_classes }}{% endif %}"{% if multiselectable == "true" %} data-allow-multiple{% endif %}>

  {% for accordion in nfipAccordions %} {# begin Accordion for loop #}
    {% set accordionID = 'nfip-accordion-' ~ accordionRandomID ~ '-' ~ loop.index %}

    <{{ accordions_heading_level }} class="usa-accordion__heading nfip-accordion__heading{% if globalTitleBG == true %} {{ accordions_bg_color }}{% else %} {{ accordion.title_bg_color }}{% endif %}{% if accordion.title_extra_classes %} {{ accordion.title_extra_classes }}{% endif %}">
      <button type="button" class="usa-accordion__button" aria-expanded="{% if expand_first == true %}{{ loop.index == 1 ? 'true' : 'false' }}{% else %}false{% endif %}" aria-controls="{{ accordionID }}">
        {% if accordion_style == "Icon" %}
          <img class="accordion-icon margin-right-2" src="{{ accordion.image_icon }}" alt="{{ accordion.image_alt }}">
        {% endif %}
        {{ accordion.title }}
      </button>
    </{{ accordions_heading_level }}>

    <div id="{{ accordionID }}" class="usa-accordion__content{% if globalContentBG == true %} {{ accordions_content_bg_color }}{% else %} {{ accordion.content_bg_color }}{% endif %}{% if accordion.content_extra_classes %} {{ accordion.content_extra_classes }}{% endif %}">

      {% if accordion.simpleContent %}{{ accordion.simpleContent }}{% endif %}

      {# for complex content, add more blocks as needed for demo pages #}
      {% if loop.index == 1 %}{% block accordion1Content %}{% endblock %}{% endif %}
      {% if loop.index == 2 %}{% block accordion2Content %}{% endblock %}{% endif %}
      {% if loop.index == 3 %}{% block accordion3Content %}{% endblock %}{% endif %}
      {% if loop.index == 4 %}{% block accordion4Content %}{% endblock %}{% endif %}
      {% if loop.index == 5 %}{% block accordion5Content %}{% endblock %}{% endif %}
      {% if loop.index == 6 %}{% block accordion6Content %}{% endblock %}{% endif %}
      {% if loop.index == 7 %}{% block accordion7Content %}{% endblock %}{% endif %}
      {% if loop.index == 8 %}{% block accordion8Content %}{% endblock %}{% endif %}
      {% if loop.index == 9 %}{% block accordion9Content %}{% endblock %}{% endif %}
      {% if loop.index == 10 %}{% block accordion10Content %}{% endblock %}{% endif %}

    </div>

  {% endfor %} {# end Accordion for loop #}

</div>